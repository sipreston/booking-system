<VirtualHost *:443>

    DocumentRoot "/var/www/booking-system/application/public"
    ServerName www.booking-system.in
    ServerAlias booking-system.in

    <Directory />
        Options +FollowSymLinks
    </Directory>

    <Directory "/var/www/booking-system/application/public/">
        Options Indexes FollowSymLinks MultiViews
        AllowOverride All
        Order deny,allow
        Allow from all
    </Directory>

    SSLEngine On
    SSLCertificateFile /etc/ssl/certs/site.crt
    SSLCertificateKeyFile /etc/ssl/certs/site.key

    <FilesMatch "\.(cgi|shtml|phtml|php)$">
        SSLOptions +StdEnvVars
    </FilesMatch>
    <Directory /usr/lib/cgi-bin>
        SSLOptions +StdEnvVars
    </Directory>

    AllowEncodedSlashes On

    <FilesMatch \.php$>
      # For Apache version 2.4.10 and above, use SetHandler to run PHP as a fastCGI process server
      SetHandler "proxy:unix:/run/php/php8.4-fpm.sock|fcgi://localhost"
    </FilesMatch>

</VirtualHost>

<VirtualHost *:80>

    DocumentRoot "/var/www/booking-system/application/public"
    ServerName www.booking-system.in
    ServerAlias booking-system.in

    <Directory />
        Options +FollowSymLinks
    </Directory>

    <Directory "/var/www/booking-system/application/public/">
        Options Indexes FollowSymLinks MultiViews
        AllowOverride All
        Order deny,allow
        Allow from all
    </Directory>

    LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-agent}i\"" combined
    ErrorLog ${APACHE_LOG_DIR}/access_error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined

    RewriteEngine On
    RewriteCond %{SERVER_PORT} 80
    RewriteRule ^/(.*)$ https://%{HTTP_HOST}/$1 [R=301,L]

    php_admin_value error_log /var/www/booking-system/application/storage/logs/php_errors.log

    LogLevel info

    AllowEncodedSlashes On

    <IfModule mod_headers.c>
        Header unset X-Runtime
        Header unset X-Powered-By
    </IfModule>

    <FilesMatch \.php$>
      # For Apache version 2.4.10 and above, use SetHandler to run PHP as a fastCGI process server
      SetHandler "proxy:unix:/run/php/php8.4-fpm.sock|fcgi://localhost"
    </FilesMatch>

    <IfModule php8_module>
        php_value newrelic.appname "booking-system"
        php_flag newrelic.capture_params on
    </IfModule>

</VirtualHost>
